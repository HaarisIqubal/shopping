<%- include('./layout/header') %>


<div class="container" style="margin-top: 100px">
    <div class="row">
        
            
            <div class="col-md-4 col-sm-12">
                        <img src="/uploads/product/<%= productDetail.product_image %>" alt="" style="width: 250px; height: 250px">
            </div>
            <div class="col-md-8 col-sm-12">
                        <h2><%= productDetail.product_name%></h2>
                        <h3>â‚¹<%= productDetail.product_total_price %></h3>
                        <% if(!isAuthenticated){ %>
                                <a href="user/login"><h5><i class="fas fa-thumbs-up"></i></h5></a> 
                                <a class="btn btn-warning btn-round" href="/user/login">
                                        <i class="material-icons fas fa-shopping-cart"></i> <i class="fas fa-plus"></i>
                                </a>
                                <a class="btn btn-danger btn-round" href="/user/login">
                                        <i class="material-icons fas fa-heart"></i> <i class="fas fa-plus"></i>
                                </a>
                                <% }else{ %>
                                        <h3><button class="btn btn-primary btn-fab btn-fab-mini btn-round" data-id="<%= productDetail._id %>" onClick="likeProduct('<%= productDetail._id%>')"><i class="material-icons fas fa-thumbs-up"></i></button><small id="counts" data-like='<%= productDetail._id%>'> &nbsp; <%= productDetail.product_likes%></small></h3> 
                                        <button onclick="addCart('<%= productDetail._id %>')" class="btn btn-warning btn-round">
                                                <i class="material-icons fas fa-shopping-cart"></i> <i class="fas fa-plus"></i>   
                                        </button>
                                        <button onclick="addFavorite('<%= productDetail._id %>')" class="btn btn-danger btn-round">
                                                <i class="material-icons fas fa-heart"></i> <i class="fas fa-plus"></i>    
                                        </button>                
                                <% } %>
            </div>
            
           <br>
           <br>
                
                 
            
            
            
        </div>
    </div>
</div>

<%- include('./layout/footer') %>

<script type="text/javascript">
    function addCart(id){
            $.ajax({
                    type: 'POST',    
                    url: '/dashboard/cart/add/'+ id +'/',
                    success: function(msg){ 
                            //$('').toast('show')
                            location.reload();
                    }
                    });
    }

    function addFavorite(id){
            $.ajax({
                    type: 'POST',    
                    url:'/dashboard/favorite/add/'+ id +'/',
                    success: function(msg){ 
                        
                            location.reload();
                    }
                    });
    }

    function likeProduct(productID){
                /*$.ajax({
                        type: 'POST',
                        url: '/dashboard/like/product/' + productID + '/',
                        success: function(msg){
                                                        
                        }
                })*/

                $.ajax({
                        type: 'POST',
                        url: '/dashboard/like/products/' + productID + '/',
                        success: function(msg){ 
                          location.reload();
                        }
                })
                /*
                $.ajax({
                        url: '/dashboard/getlikes/products/' + productID,
                        type: 'GET',
                        contentType: 'application/json; charset=utf-8',
                        success: function(message){
                        console.log(message.count)
                        }
                })*/
                                
        }


    $(document).ready(function(){
                
                $('.likeBtn').click(function(){
                        const productID = $(this).data("id")
                        const level = $(this).data('level')
                        $(this).removeClass('btn-primary');      
                        $(this).addClass('disabled btn-primary');
                })
                })  

    </script>